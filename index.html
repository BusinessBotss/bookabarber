<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reserva Barbero a Domicilio</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#121212">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #121212;
      --card: rgba(25,27,30,0.75);
      --accent: #f5f5f5;
      --text: #e0e0e0;
      --text-sec: #8b949e;
      --shadow: rgba(0,0,0,0.7);
      --radius: 12px;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{display:flex;justify-content:center;align-items:center;min-height:100vh;background:var(--bg);font-family:'Poppins',sans-serif;color:var(--text);padding:1rem;}
    .card{position:relative;width:360px;padding:2rem;background:var(--card);border-radius:var(--radius);backdrop-filter:blur(10px);box-shadow:0 8px 16px var(--shadow);animation:fadeIn 0.6s ease-out;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    h1{text-align:center;margin-bottom:1rem;color:var(--accent);font-weight:600;letter-spacing:1px;}
    .fav-btn{position:absolute;top:1rem;right:1rem;background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-sec);transition:color .2s;}
    .fav-btn.active{color:gold;}
    .field{margin-bottom:1rem;}
    label{display:block;margin-bottom:.5rem;font-size:.9rem;color:var(--text-sec);}
    input,select,textarea{width:100%;padding:.75rem;border:none;border-radius:8px;background:rgba(255,255,255,0.05);color:var(--text);font-size:.95rem;box-shadow:inset 0 2px 4px rgba(0,0,0,0.6);transition:background .2s,box-shadow .2s;}
    input::placeholder,textarea::placeholder{color:var(--text-sec);}
    input:focus,select:focus,textarea:focus{outline:none;background:rgba(255,255,255,0.1);box-shadow:0 0 0 2px var(--accent);}
    .surcharge{display:flex;align-items:center;gap:.5rem;}
    .surcharge input{transform:scale(1.2);}
    .btn{width:100%;padding:.75rem;background:linear-gradient(90deg,#00e5ff,#00a8ff);color:#121212;font-weight:600;border:none;border-radius:var(--radius);cursor:pointer;box-shadow:0 6px 10px var(--shadow);transition:transform .2s,box-shadow .2s;}
    .btn:disabled{opacity:.5;cursor:not-allowed;}
    .btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 12px 16px var(--shadow);}
    #summary{margin-top:1.5rem;padding:1rem;background:rgba(255,255,255,0.05);border-radius:var(--radius);font-size:.95rem;line-height:1.4;white-space:pre-wrap;}
    .hidden{display:none;}
    .error{border:1px solid #f66;}
    .error-msg{color:#f66;font-size:.8rem;margin-top:.25rem;}
  </style>
</head>
<body>
  <div class="card">
    <button class="fav-btn" id="fav-btn" aria-label="Marcar favorito">☆</button>
    <h1>Reserva tu Servicio</h1>
    <form id="booking-form" novalidate>
      <div class="field">
        <label for="service">Servicio</label>
        <select id="service" required>
          <option value="" disabled selected>-- Elige Servicio --</option>
          <option value="Cortar">Cortar - 12,00€</option>
          <option value="Tinte">Tinte desde 10,00€</option>
          <option value="Mechas">Mechas desde 10,00€</option>
          <option value="Afeitar">Afeitar - 8,00€</option>
          <option value="Alisado">Alisado desde 10,00€</option>
          <option value="Niños">Niños - 10,00€</option>
        </select>
        <div class="error-msg hidden" id="error-service">Seleccione un servicio</div>
      </div>
      <div class="field">
        <label for="date">Fecha</label>
        <input type="date" id="date" required min="" />
        <div class="error-msg hidden" id="error-date">Fecha inválida</div>
      </div>
      <div class="field">
        <label for="time">Hora</label>
        <input type="time" id="time" required min="09:00" max="22:00" step="900" />
        <div class="error-msg hidden" id="error-time">Hora fuera de rango (09:00-22:00)</div>
      </div>
      <div class="field">
        <label for="name">Nombre</label>
        <input type="text" id="name" placeholder="Tu nombre" required />
        <div class="error-msg hidden" id="error-name">Ingrese su nombre</div>
      </div>
      <div class="field">
        <label for="phone">Teléfono</label>
        <input type="tel" id="phone" placeholder="+34 600 000 000" required />
        <div class="error-msg hidden" id="error-phone">Formato: +34 9 dígitos</div>
      </div>
      <div class="field surcharge">
        <input type="checkbox" id="plus-travel" />
        <label for="plus-travel">Plus desplazamiento en Palma (+30,00€)</label>
      </div>
      <button type="submit" class="btn" id="btn-generate" disabled>Ver Resumen</button>
    </form>
    <div id="summary" class="hidden" role="region" aria-live="polite"></div>
    <button id="btn-send" class="btn hidden">Enviar por WhatsApp</button>
  </div>
  <script>
    // Setup
    const priceMap={Cortar:12,Tinte:10,Mechas:10,Afeitar:8,Alisado:10,'Niños':10};
    const form=document.getElementById('booking-form');
    const btnGen=document.getElementById('btn-generate'), btnSend=document.getElementById('btn-send');
    const summaryEl=document.getElementById('summary');
    const serviceEl=document.getElementById('service'), dateEl=document.getElementById('date'), timeEl=document.getElementById('time'), nameEl=document.getElementById('name'), phoneEl=document.getElementById('phone'), plusEl=document.getElementById('plus-travel');
    const errors={service:'error-service',date:'error-date',time:'error-time',name:'error-name',phone:'error-phone'};
    // Fecha mínima
    dateEl.min=new Date().toISOString().split('T')[0];
    // Favorito
    const favKey='fav';
    const favBtn=document.getElementById('fav-btn');
    function loadFav(){const f=JSON.parse(localStorage.getItem(favKey));if(f){serviceEl.value=f.service;dateEl.value=f.date;timeEl.value=f.time;nameEl.value=f.name;phoneEl.value=f.phone;plusEl.checked=f.plus;favBtn.classList.add('active');}}
    favBtn.addEventListener('click',()=>{if(favBtn.classList.toggle('active')){localStorage.setItem(favKey,JSON.stringify({service:serviceEl.value,date:dateEl.value,time:timeEl.value,name:nameEl.value,phone:phoneEl.value,plus:plusEl.checked}));}else localStorage.removeItem(favKey);});
    // Validación inline
    function validateField(el,validator,id){const valid=validator(el.value);el.classList.toggle('error',!valid);document.getElementById(id).classList.toggle('hidden',valid);return valid;}
    function validateForm(){const vService=validateField(serviceEl,v=>!!v,errors.service);const vDate=validateField(dateEl,v=>v>=dateEl.min,errors.date);const vTime=validateField(timeEl,v=>v>=timeEl.min&&v<=timeEl.max,errors.time);const vName=validateField(nameEl,v=>v.trim(),errors.name);const vPhone=validateField(phoneEl,v=>/^\+34\s?\d{9}$/.test(v),errors.phone);btnGen.disabled=!(vService&&vDate&&vTime&&vName&&vPhone);} 
    [serviceEl,dateEl,timeEl,nameEl,phoneEl].forEach(el=>el.addEventListener('input',validateForm));
    // Submit
    form.addEventListener('submit',e=>{e.preventDefault();const s=serviceEl.value,d=dateEl.value,t=timeEl.value,n=nameEl.value,p=phoneEl.value,pl=plusEl.checked;let price=priceMap[s]||0;if(pl)price+=30;const txt=`Resumen de la Reserva:\n- Servicio: ${s}\n- Fecha: ${d}\n- Hora: ${t}\n- Desplazamiento en Palma: ${pl?'Sí (+30,00€)':'No'}\n- Precio estimado: ${price.toFixed(2)}€\n- Nombre: ${n}\n- Teléfono: ${p}`;summaryEl.textContent=txt;summaryEl.classList.remove('hidden');btnSend.classList.remove('hidden');});
    btnSend.addEventListener('click',()=>{const p=phoneEl.value.replace(/\s+/g,'');window.open(`https://wa.me/${p}?text=${encodeURIComponent(summaryEl.textContent)}`,'_blank');});
    loadFav();
  </script>
</body>
</html>